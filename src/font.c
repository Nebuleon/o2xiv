/*
 * O2xIV
 * Copyright (C) 2008 Carl Reinke (rendering code),
 *               2014 Nebuleon <nebuleon@gcw-zero.com> (font data)
 * 
 * This program is free software; you can redistribute it and/or
 * modify it under the terms of the GNU General Public License
 * as published by the Free Software Foundation; either version 2
 * of the License, or (at your option) any later version.
 * 
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 * 
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.
 * 
 * The font data is also offered under the terms of the Creative Commons
 * Attribution-ShareAlike 3.0 License:
 * <http://creativecommons.org/licenses/by-sa/3.0/>
 */
#include "assert.h"

#include "SDL.h"

#include "font.h"
#include "main.h"

unsigned char fontdata8x8[][8] =
{
	{ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00 },
	{ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00 },
	{ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00 },
	{ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00 },
	{ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00 },
	{ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00 },
	{ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00 },
	{ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00 },
	{ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00 },
	{ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00 },
	{ 0x3C,0x42,0x99,0xBD,0xBD,0x99,0x42,0x3C },
	{ 0x3C,0x42,0x81,0x81,0x81,0x81,0x42,0x3C },
	{ 0xFE,0x82,0x8A,0xD2,0xA2,0x82,0xFE,0x00 },
	{ 0xFE,0x82,0x82,0x82,0x82,0x82,0xFE,0x00 },
	{ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00 },
	{ 0x00,0x38,0x64,0x74,0x7C,0x38,0x00,0x00 },
	{ 0x80,0xC0,0xF0,0xFC,0xF0,0xC0,0x80,0x00 },
	{ 0x01,0x03,0x0F,0x3F,0x0F,0x03,0x01,0x00 },
	{ 0x18,0x3C,0x7E,0x18,0x7E,0x3C,0x18,0x00 },
	{ 0xEE,0xEE,0xEE,0xCC,0x00,0xCC,0xCC,0x00 },
	{ 0x00,0x00,0x30,0x68,0x78,0x30,0x00,0x00 },
	{ 0x00,0x38,0x64,0x74,0x7C,0x38,0x00,0x00 },
	{ 0x3C,0x66,0x7A,0x7A,0x7E,0x7E,0x3C,0x00 },
	{ 0x0E,0x3E,0x3A,0x22,0x26,0x6E,0xE4,0x40 },
	{ 0x18,0x3C,0x7E,0x3C,0x3C,0x3C,0x3C,0x00 },
	{ 0x3C,0x3C,0x3C,0x3C,0x7E,0x3C,0x18,0x00 },
	{ 0x08,0x7C,0x7E,0x7E,0x7C,0x08,0x00,0x00 },
	{ 0x10,0x3E,0x7E,0x7E,0x3E,0x10,0x00,0x00 },
	{ 0x58,0x2A,0xDC,0xC8,0xDC,0x2A,0x58,0x00 },
	{ 0x24,0x66,0xFF,0xFF,0x66,0x24,0x00,0x00 },
	{ 0x00,0x10,0x10,0x38,0x38,0x7C,0xFE,0x00 },
	{ 0xFE,0x7C,0x38,0x38,0x10,0x10,0x00,0x00 },
	{ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00 }, // SPACE
	{ 0x18,0x18,0x18,0x18,0x00,0x18,0x18,0x00 }, // !
	{ 0x6C,0x6C,0x6C,0x00,0x00,0x00,0x00,0x00 }, // "
	{ 0x6C,0x6C,0x7C,0x6C,0x7C,0x6C,0x6C,0x00 }, // #
	{ 0x00,0x10,0x6C,0xD0,0x6C,0x16,0x6C,0x10 }, // $
	{ 0x66,0x66,0x0C,0x18,0x30,0x66,0x66,0x00 }, // %
	{ 0x18,0x34,0x18,0x3A,0x6C,0x66,0x3A,0x00 }, // &
	{ 0x18,0x18,0x18,0x00,0x00,0x00,0x00,0x00 }, // '
	{ 0x06,0x18,0x30,0x30,0x30,0x18,0x06,0x00 }, // (
	{ 0xC0,0x30,0x18,0x18,0x18,0x30,0xC0,0x00 }, // )
	{ 0x54,0x38,0x7C,0x38,0x54,0x00,0x00,0x00 }, // *
	{ 0x00,0x18,0x18,0x7E,0x18,0x18,0x00,0x00 }, // +
	{ 0x00,0x00,0x00,0x00,0x00,0x18,0x18,0x30 }, // ,
	{ 0x00,0x00,0x00,0x00,0x7E,0x00,0x00,0x00 }, // -
	{ 0x00,0x00,0x00,0x00,0x00,0x18,0x18,0x00 }, // .
	{ 0x06,0x06,0x0C,0x18,0x30,0x60,0x60,0x00 }, // /
	{ 0x3C,0x66,0x66,0x66,0x66,0x66,0x3C,0x00 }, // 0
	{ 0x18,0x38,0x78,0x18,0x18,0x18,0x7E,0x00 },
	{ 0x3C,0x66,0x06,0x0C,0x18,0x30,0x7E,0x00 },
	{ 0x3C,0x06,0x06,0x3C,0x06,0x06,0x3C,0x00 },
	{ 0x0C,0x6C,0x6C,0x7E,0x0C,0x0C,0x0C,0x00 },
	{ 0x7E,0x60,0x60,0x7C,0x06,0x66,0x3C,0x00 },
	{ 0x3C,0x60,0x60,0x7C,0x66,0x66,0x3C,0x00 },
	{ 0x7E,0x06,0x06,0x0C,0x0C,0x18,0x18,0x00 },
	{ 0x3C,0x66,0x66,0x3C,0x66,0x66,0x3C,0x00 },
	{ 0x3C,0x66,0x66,0x3E,0x06,0x06,0x3C,0x00 }, // 9
	{ 0x00,0x00,0x18,0x18,0x00,0x18,0x18,0x00 }, // :
	{ 0x00,0x00,0x18,0x08,0x00,0x18,0x18,0x30 }, // ;
	{ 0x00,0x00,0x06,0x18,0x60,0x18,0x06,0x00 }, // <
	{ 0x00,0x00,0x00,0x7E,0x00,0x7E,0x00,0x00 }, // =
	{ 0x00,0x00,0x60,0x18,0x06,0x18,0x60,0x00 }, // >
	{ 0x3C,0x06,0x0C,0x18,0x00,0x18,0x18,0x00 }, // ?
	{ 0x3C,0x66,0x7E,0x66,0x7C,0x60,0x3C,0x00 }, // @
	{ 0x38,0x6C,0x6C,0xC6,0xFE,0xC6,0xC6,0x00 }, // A
	{ 0x7C,0x66,0x66,0x7C,0x66,0x66,0x7C,0x00 },
	{ 0x3C,0x66,0x60,0x60,0x60,0x66,0x3C,0x00 },
	{ 0x78,0x6C,0x66,0x66,0x66,0x6C,0x78,0x00 },
	{ 0x7E,0x60,0x60,0x7C,0x60,0x60,0x7E,0x00 },
	{ 0x7E,0x60,0x60,0x7C,0x60,0x60,0x60,0x00 },
	{ 0x3C,0x66,0x60,0x6E,0x66,0x66,0x3C,0x00 },
	{ 0x66,0x66,0x66,0x7E,0x66,0x66,0x66,0x00 },
	{ 0x7E,0x18,0x18,0x18,0x18,0x18,0x7E,0x00 },
	{ 0x06,0x06,0x06,0x06,0x66,0x66,0x3C,0x00 },
	{ 0x66,0x66,0x6C,0x78,0x6C,0x66,0x66,0x00 },
	{ 0x60,0x60,0x60,0x60,0x60,0x60,0x7E,0x00 },
	{ 0xC6,0xEE,0xFE,0xFE,0xD6,0xC6,0xC6,0x00 },
	{ 0xC6,0xE6,0xF6,0xFE,0xDE,0xCE,0xC6,0x00 },
	{ 0x38,0x6C,0xC6,0xC6,0xC6,0x6C,0x38,0x00 },
	{ 0x7C,0x66,0x66,0x7C,0x60,0x60,0x60,0x00 },
	{ 0x38,0x6C,0xC6,0xC7,0xC6,0x6C,0x3A,0x00 },
	{ 0x7C,0x66,0x66,0x7C,0x6C,0x66,0x66,0x00 },
	{ 0x3C,0x66,0x60,0x3C,0x06,0x66,0x3C,0x00 },
	{ 0x7E,0x18,0x18,0x18,0x18,0x18,0x18,0x00 },
	{ 0x66,0x66,0x66,0x66,0x66,0x66,0x3C,0x00 },
	{ 0xC6,0xC6,0xC6,0x6C,0x6C,0x6C,0x38,0x00 },
	{ 0xD6,0xD6,0xD6,0xD6,0xD6,0xD6,0x6C,0x00 },
	{ 0x66,0x66,0x66,0x3C,0x66,0x66,0x66,0x00 },
	{ 0x66,0x66,0x66,0x3C,0x18,0x18,0x18,0x00 },
	{ 0x7E,0x06,0x0C,0x18,0x30,0x60,0x7E,0x00 },
	{ 0x3C,0x30,0x30,0x30,0x30,0x30,0x3C,0x00 }, // [
	{ 0x60,0x60,0x30,0x18,0x0C,0x06,0x06,0x00 }, // BACKSLASH
	{ 0x78,0x18,0x18,0x18,0x18,0x18,0x78,0x00 }, // ]
	{ 0x18,0x3C,0x66,0x00,0x00,0x00,0x00,0x00 }, // ^
	{ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF }, // _
	{ 0x30,0x18,0x0C,0x00,0x00,0x00,0x00,0x00 }, // `
	{ 0x00,0x00,0x3C,0x06,0x3E,0x66,0x3A,0x00 }, // a
	{ 0x60,0x60,0x7C,0x66,0x66,0x66,0x5C,0x00 },
	{ 0x00,0x00,0x3C,0x66,0x60,0x66,0x3C,0x00 },
	{ 0x06,0x06,0x3E,0x66,0x66,0x66,0x3A,0x00 },
	{ 0x00,0x00,0x3C,0x66,0x7E,0x60,0x3C,0x00 },
	{ 0x1E,0x30,0x7C,0x30,0x30,0x30,0x30,0x00 },
	{ 0x00,0x00,0x3A,0x66,0x66,0x3E,0x06,0x3C },
	{ 0x60,0x60,0x7C,0x66,0x66,0x66,0x66,0x00 },
	{ 0x18,0x00,0x38,0x18,0x18,0x18,0x3C,0x00 },
	{ 0x18,0x00,0x38,0x18,0x18,0x18,0x18,0x70 },
	{ 0x60,0x60,0x66,0x6C,0x78,0x6C,0x66,0x00 },
	{ 0x38,0x18,0x18,0x18,0x18,0x18,0x3C,0x00 },
	{ 0x00,0x00,0xAC,0xD6,0xD6,0xD6,0xD6,0x00 },
	{ 0x00,0x00,0x5C,0x66,0x66,0x66,0x66,0x00 },
	{ 0x00,0x00,0x3C,0x66,0x66,0x66,0x3C,0x00 },
	{ 0x00,0x00,0x5C,0x66,0x66,0x7C,0x60,0x60 },
	{ 0x00,0x00,0x3A,0x66,0x66,0x3E,0x06,0x06 },
	{ 0x00,0x00,0x5E,0x60,0x60,0x60,0x60,0x00 },
	{ 0x00,0x00,0x3C,0x60,0x3C,0x06,0x3C,0x00 },
	{ 0x18,0x18,0x3C,0x18,0x18,0x18,0x0E,0x00 },
	{ 0x00,0x00,0x66,0x66,0x66,0x66,0x3A,0x00 },
	{ 0x00,0x00,0x66,0x66,0x66,0x3C,0x18,0x00 },
	{ 0x00,0x00,0xD6,0xD6,0xD6,0xD6,0x6C,0x00 },
	{ 0x00,0x00,0x66,0x3C,0x18,0x3C,0x66,0x00 },
	{ 0x00,0x00,0x66,0x66,0x66,0x3E,0x06,0x3C },
	{ 0x00,0x00,0x7E,0x0C,0x18,0x30,0x7E,0x00 }, // z
	{ 0x0E,0x18,0x18,0x30,0x18,0x18,0x0E,0x00 }, // {
	{ 0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x00 }, // |
	{ 0x70,0x18,0x18,0x0C,0x18,0x18,0x70,0x00 }, // }
	{ 0x00,0x00,0x60,0x92,0xC0,0x00,0x00,0x00 }, // ~
	{ 0x00,0x7E,0x66,0x66,0x66,0x7E,0x00,0x00 }, // DEL
};

void char8x8( SDL_Surface *const surface, int x, int y, const char c, const Uint16 color ) {
	assert(x >= 0 && y >= 0);
	
	const unsigned int bpp = surface->format->BytesPerPixel;
	Uint8 *s = (Uint8 *)surface->pixels + y * surface->pitch + x * bpp;
	
	for (unsigned int y = 0; y < 8; y++) {
		int temp;
		if ((unsigned int) c > sizeof(fontdata8x8) / sizeof(fontdata8x8[0]))
			temp = fontdata8x8[0x7F][y];
		else
			temp = fontdata8x8[(int)c][y];
		for (unsigned int x = 0; x < 8; x++) {
			if (temp & 0x80)
				*(Uint16 *)s = color;
			s += bpp;
			temp <<= 1;
		}
		s += surface->pitch - 8 * bpp;
	}
}

void text8x8( SDL_Surface *const surface, int x, int y, const char text[], const Uint16 color ) {
	assert(y >= 0 && y + 8 < surface->h);
	for (unsigned int i = 0; i < strlen(text); i++) {
		assert(x >= 0 && x + 8 < surface->w);
		char8x8(surface, x, y, text[i], color);
		x += 8;
	}
}

void outline8x8( SDL_Surface *const surface, int x, int y, const char text[], const Uint16 color, const Uint16 outline ) {
	text8x8(surface, x - 1, y,     text, outline);
	text8x8(surface, x,     y - 1, text, outline);
	text8x8(surface, x + 1, y,     text, outline);
	text8x8(surface, x,     y + 1, text, outline);
	text8x8(surface, x,     y,     text, color);
}

// kate: tab-width 4;
